%global __brp_check_rpaths %{nil}
%global packname  netchain
%global packver   0.2.0
%global rlibdir   /usr/local/lib/R/library

Name:             R-CRAN-%{packname}
Version:          0.2.0
Release:          3%{?dist}%{?buildtag}
Summary:          Inferring Causal Effects on Collective Outcomes underInterference

License:          GPL (>= 3) | file LICENSE
URL:              https://cran.r-project.org/package=%{packname}
Source0:          %{url}&version=%{packver}#/%{packname}_%{packver}.tar.gz


BuildRequires:    R-devel
Requires:         R-core
BuildRequires:    R-CRAN-Rcpp >= 0.12.17
BuildRequires:    R-Matrix 
BuildRequires:    R-CRAN-gtools 
BuildRequires:    R-CRAN-stringr 
BuildRequires:    R-stats 
BuildRequires:    R-CRAN-igraph 
Requires:         R-CRAN-Rcpp >= 0.12.17
Requires:         R-Matrix 
Requires:         R-CRAN-gtools 
Requires:         R-CRAN-stringr 
Requires:         R-stats 
Requires:         R-CRAN-igraph 

%description
In networks, treatments may spill over from the treated individual to his
or her social contacts and outcomes may be contagious over time. Under
this setting, causal inference on the collective outcome observed over all
network is often of interest. We use chain graph models approximating the
projection of the full longitudinal data onto the observed data to
identify the causal effect of the intervention on the whole outcome.
Justification of such approximation is demonstrated in Ogburn et al.
(2018) <arXiv:1812.04990>.

%prep
%setup -q -c -n %{packname}

find -type f -executable -exec grep -Iq . {} \; -exec sed -i -e '$a\' {} \;

%build

%install

mkdir -p %{buildroot}%{rlibdir}
%{_bindir}/R CMD INSTALL -l %{buildroot}%{rlibdir} %{packname}

test -d %{packname}/src && (cd %{packname}/src; rm -f *.o *.so)
rm -f %{buildroot}%{rlibdir}/R.css

%files
%{rlibdir}/%{packname}
